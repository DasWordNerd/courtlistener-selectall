{% load static %}

{% if DEBUG %}
  <script defer type="application/javascript"
          src="{% static "js/select2.js" %}"></script>
{% else %}
  <script defer type="application/javascript"
          src="{% static "js/select2.min.js" %}"></script>
{% endif %}
<script type="text/javascript">
  $(document).ready(function() {
    $('.select2').select2({
      ajax: {
        url: "/api/rest/v3/schools/",
        dataType: "json",
        delay: 250,
        data: function(params) {
          return {name__icontains: params.term, order_by: "name"};
        },
        processResults: function(data, params){
          params.page = params.page || 1
          return {
            results: data.results.map(function(result){return {
              id: result.id,
              text: result.name,
            }}),
            pagination: {
              more: !!data.next,
            }
          }
        }
      }
    });
  });
</script>
